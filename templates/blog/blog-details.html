{% extends "shop/base.html" %}
{% load static %}
{% block content %}
<div class="breadcrumb-area pt-95 pb-95 bg-img" style="background-image:url('{% static 'shop/img/banners/banner-2.jpg' %}');">
    <div class="container">
        <div class="breadcrumb-content text-center">
            <h2>Post Details</h2>
            <ul>
                <li><a href="{% url 'shop:index' %}">Home</a></li>
                <li class="active">Post Details</li>
            </ul>
        </div>
    </div>
</div>
<div class="shop-area pt-100 pb-100">
    <div class="container">
        <div class="row flex-row-reverse">
            <div class="col-lg-9 col-md-8">
                <div class="blog-details-wrapper res-mrg-top">
                    <div class="single-blog-wrapper">
                        <div class="blog-img mb-30">
                            <img src="{{ post.cover_image.url }}" alt="{{ post.title }}">
                        </div>
                        <div class="blog-details-content">
                            <h2>{{ post.title }}</h2>
                            <div class="blog-meta">
                                <ul>
                                    <li>{{ post.published_date|date:"F d, Y" }}</li>
                                    <li>
                                        <a href="#"> {{ post.comments.count }} Comments</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="post-content">
                            {{ post.content|safe }}
                        </div>
                        <div class="blog-dec-tags-social mt-50">
                            <div class="blog-dec-tags">
                                <ul>
                                    {% for tag in post.tags.all %}
                                    <li><a href="{% url 'blog:blog_by_tag' tag_slug=tag.slug %}">{{ tag.name }}</a></li>
                                    {% endfor %}
                                </ul>
                            </div>
                            <div class="blog-dec-social">
                                <span>Share:</span>
                                <ul>
                                    <li><a href="#"><i class="icon-social-twitter"></i></a></li>
                                    <li><a href="#"><i class="icon-social-instagram"></i></a></li>
                                    <li><a href="#"><i class="icon-social-dribbble"></i></a></li>
                                    <li><a href="#"><i class="icon-social-linkedin"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="blog-comment-wrapper mt-55">
                        <h4 class="blog-dec-title">Comments: {{ post.comments.count }}</h4>
                        {% for comment in post.comments.all %}
                        <div class="single-comment-wrapper mt-35">
                            <div class="blog-comment-img">
                                {% if comment.avatar_url %}
                                <img src="{{ comment.avatar_url }}" alt="User Avatar" class="rounded-avatar">
                                {% else %}
                                <img src="{% static 'shop/img/logo.jpg' %}" alt="Default Avatar" class="rounded-avatar">
                                {% endif %}
                            </div>
                            <div class="blog-comment-content">
                                <h4>{{ comment.author_name }}</h4>
                                <span>{{ comment.published_date|date:"F d, Y" }}</span>
                                <p>{{ comment.content|linebreaksbr|truncatechars:500 }}</p>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="blog-reply-wrapper mt-50">
                        <h4 class="blog-dec-title">Post a Comment</h4>
                        <form action="{% url 'blog:add_comment' post.id %}" method="POST">
                            {% csrf_token %}
                            <div class="row">
                                {% if request.user.is_authenticated %}
                                <div class="col-md-12">
                                    <div class="leave-form">
                                        <textarea name="content" placeholder="Message" maxlength="500" required></textarea>
                                    </div>
                                </div>
                                {% else %}
                                <div class="col-md-6">
                                    <div class="leave-form">
                                        <input type="text" name="author_name" placeholder="First Name" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="leave-form">
                                        <input type="text" name="author_last_name" placeholder="Last Name" required>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="leave-form">
                                        <input type="email" name="author_email" placeholder="Email Address" required>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="leave-form">
                                        <textarea name="content" placeholder="Message" maxlength="500" required></textarea>
                                    </div>
                                </div>
                                {% endif %}
                                <div class="col-md-12">
                                    <div class="text-leave">
                                        <input type="submit" value="SEND MESSAGE">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-4">
                <div class="shop-sidebar blog-mrg">
                    <div class="shop-widget">
                        <h4 class="shop-sidebar-title">Search</h4>
                        <div class="shop-search mt-25 mb-50">
                            <form class="shop-search-form" method="GET" action="{% url 'blog:blog' %}">
                                <input type="text" name="q" placeholder="Find a post">
                                <button type="submit"><i class="icon-magnifier"></i></button>
                            </form>
                        </div>
                    </div>
                    <div class="shop-widget mt-50">
                        <h4 class="shop-sidebar-title">Category</h4>
                        <div class="shop-list-style mt-20">
                            <ul>
                                {% for category in categories %}
                                <li><a href="{% url 'blog:blog_by_category' category_slug=category.slug %}">{{ category.name }}</a></li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                    <div class="shop-widget mt-50">
                        <h4 class="shop-sidebar-title">Tags</h4>
                        <div class="shop-list-style mt-20">
                            <ul>
                                {% for tag in tags %}
                                <li><a href="{% url 'blog:blog_by_tag' tag_slug=tag.slug %}">{{ tag.name }}</a></li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                    <div class="shop-widget mt-50">
                        <h4 class="shop-sidebar-title">Recent Post</h4>
                        <div class="recent-post-wrapper mt-25">
                            {% for recent_post in recent_posts %}
                            <div class="single-recent-post mb-20">
                                <div class="recent-post-img">
                                    <a href="{% url 'blog:blog_details' recent_post.id %}"><img src="{{ recent_post.cover_image.url }}" alt="{{ recent_post.title }}"></a>
                                </div>
                                <div class="recent-post-content">
                                    <h4><a href="{% url 'blog:blog_details' recent_post.id %}">{{ recent_post.title }}</a></h4>
                                    <span>{{ recent_post.published_date|date:"F d, Y" }} </span>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
